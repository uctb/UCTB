

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3. Urban Datasets &mdash; UCTB  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="UCTB  documentation" href="../index.html"/>
        <link rel="next" title="4. Predictive Tool" href="predictive_tool.html"/>
        <link rel="prev" title="2. Installation" href="installation.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> UCTB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Urban Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#datasets-overview">3.1. Datasets Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-uctb-dataset">3.2. Load UCTB Dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataset-format">3.2.1. Dataset format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-datasets-from-urban-datasets">3.2.2. Use datasets from Urban Datasets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-get-the-datasets-at-other-granularities">3.3. How to get the datasets at other granularities?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-your-own-datasets">3.4. Build your own datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="predictive_tool.html">4. Predictive Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization_tool.html">5. Visualization Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../APIReference.html">6. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="all_results.html">7. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="uctb_group.html">8. About us (UCTB Group)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">UCTB</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">3. </span>Urban Datasets</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/md_file/urban_dataset.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="urban-datasets">
<h1><span class="section-number">3. </span>Urban Datasets<a class="headerlink" href="#urban-datasets" title="Permalink to this heading">¶</a></h1>
<p>UCTB is designed for urban computing in various scenarios. Currently, It releases <a class="reference external" href="https://github.com/uctb/Urban-Dataset">a public dataset repository</a> including bike sharing, ride sharing, traffic speed, and pedestrian counting applications. <strong>If you are interested in this project, making a contribution to the dataset is strongly welcomed :)</strong></p>
<section id="datasets-overview">
<h2><span class="section-number">3.1. </span>Datasets Overview<a class="headerlink" href="#datasets-overview" title="Permalink to this heading">¶</a></h2>
<p>Currently, UCTB offers the following datasets in 7 scenarios, with detailed information provided in the table below. We are constantly working to release more datasets in the future.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: center;"><strong>Application</strong></th>
<th style="text-align: center;"><strong>City</strong></th>
<th style="text-align: center;"><strong>Time Range</strong></th>
<th style="text-align: center;"><strong>Temporal Granularity</strong></th>
<th style="text-align: center;"><strong>Dataset Link</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Bike-sharing</td>
<td style="text-align: center;">NYC</td>
<td style="text-align: center;">2013.07.01-2017.09.30</td>
<td style="text-align: center;">5 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Bike/5_minutes/Bike_NYC.zip">66.0M</a></td>
</tr>
<tr>
<td style="text-align: center;">Bike-sharing</td>
<td style="text-align: center;">Chicago</td>
<td style="text-align: center;">2013.07.01-2017.09.30</td>
<td style="text-align: center;">5 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Bike/5_minutes/Bike_Chicago.zip">30.2M</a></td>
</tr>
<tr>
<td style="text-align: center;">Bike-sharing</td>
<td style="text-align: center;">DC</td>
<td style="text-align: center;">2013.07.01-2017.09.30</td>
<td style="text-align: center;">5 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Bike/5_minutes/Bike_DC.zip">31.0M</a></td>
</tr>
<tr>
<td style="text-align: center;">Pedestrian Count</td>
<td style="text-align: center;">Melbourne</td>
<td style="text-align: center;">2021.01.01-2022.11.01</td>
<td style="text-align: center;">60 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Pedestrian/60_minutes/Pedestrian_Melbourne.pkl.zip">1.18M</a></td>
</tr>
<tr>
<td style="text-align: center;">Vehicle Speed</td>
<td style="text-align: center;">LA</td>
<td style="text-align: center;">2012.03.01-2012.06.28</td>
<td style="text-align: center;">5 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Speed/5_minutes/METR_LA.zip">11.8M</a></td>
</tr>
<tr>
<td style="text-align: center;">Vehicle Speed</td>
<td style="text-align: center;">BAY</td>
<td style="text-align: center;">2017.01.01-2017.07.01</td>
<td style="text-align: center;">5 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Speed/5_minutes/PEMS_BAY.zip">27.9M</a></td>
</tr>
<tr>
<td style="text-align: center;">Taxi Demand</td>
<td style="text-align: center;">Chicago</td>
<td style="text-align: center;">2013.01.01-2018.01.01</td>
<td style="text-align: center;">15 minutes</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Taxi/15_minutes/Taxi_Chicago.zip">6.1M</a></td>
</tr>
<tr>
<td style="text-align: center;">Bus</td>
<td style="text-align: center;">NYC</td>
<td style="text-align: center;">2022.02.01-2024.01.13</td>
<td style="text-align: center;">60 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Bus/60_minutes/Bus_NYC.zip">4.89M</a></td>
</tr>
<tr>
<td style="text-align: center;">Metro</td>
<td style="text-align: center;">NYC</td>
<td style="text-align: center;">2022.02.01-2023.12.21</td>
<td style="text-align: center;">60 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Metro/60_minutes/Metro_NYC.zip">11.3M</a></td>
</tr>
<tr>
<td style="text-align: center;">Traffic Flow</td>
<td style="text-align: center;">Luzern</td>
<td style="text-align: center;">2015.01.01-2016.01.01</td>
<td style="text-align: center;">3 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Flow/3_minutes/Flow_Luzern.zip">21M</a></td>
</tr>
<tr>
<td style="text-align: center;">Ride-sharing</td>
<td style="text-align: center;">Chicago (community)</td>
<td style="text-align: center;">2013.01.01-2018.01.01</td>
<td style="text-align: center;">15 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Taxi/15_minutes/Taxi_Chicago.zip">6.06</a></td>
</tr>
<tr>
<td style="text-align: center;">Ride-sharing</td>
<td style="text-align: center;">Chicago (census tract)</td>
<td style="text-align: center;">2013.01.01-2018.01.01</td>
<td style="text-align: center;">15 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Taxi/15_minutes/Taxi_fine_grained_Chicago.zip">10M</a></td>
</tr>
<tr>
<td style="text-align: center;">Ride-sharing</td>
<td style="text-align: center;">NYC</td>
<td style="text-align: center;">2009.01.01-2023.06.01</td>
<td style="text-align: center;">5 mins</td>
<td style="text-align: center;"><a href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Taxi/5_minutes/Taxi_NYC.zip">36.9M</a></td>
</tr>
</tbody>
</table></section>
<section id="load-uctb-dataset">
<h2><span class="section-number">3.2. </span>Load UCTB Dataset<a class="headerlink" href="#load-uctb-dataset" title="Permalink to this heading">¶</a></h2>
<!-- TODO: 介绍pickle --><p>The <code class="docutils literal notranslate"><span class="pre">pickle</span></code> module is an external library that comes built-in with Python and provides functionality for converting Python objects into a byte stream (serialization) and restoring them back to their original state (deserialization). We use it to help data format instances to transform between memory and disk.</p>
<section id="dataset-format">
<h3><span class="section-number">3.2.1. </span>Dataset format<a class="headerlink" href="#dataset-format" title="Permalink to this heading">¶</a></h3>
<p>We’ve collected some public datasets and processing them into UCTB dataset format. UCTB dataset is a python build-in dictionary object that could be loaded by pickle package. Here is the example of UCTB dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s say ``my_dataset`` is your dataset.</span>
<span class="n">my_dataset</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;TimeRange&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">,</span> <span class="s1">&#39;YYYY-MM-DD&#39;</span><span class="p">],</span>
    <span class="s2">&quot;TimeFitness&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="c1"># Minutes</span>
    
    <span class="s2">&quot;Node&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;TrafficNode&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="c1"># With shape [time, num-of-node]</span>
        <span class="s2">&quot;TrafficMonthlyInteraction&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="c1"># With shape [month, num-of-node. num-of-node]</span>
        <span class="s2">&quot;StationInfo&quot;</span><span class="p">:</span> <span class="nb">list</span> <span class="c1"># elements in it should be [id, build-time, lat, lng, name]</span>
        <span class="s2">&quot;POI&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">},</span>

    <span class="s2">&quot;Grid&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;TrafficGrid&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;GridLatLng&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;POI&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">},</span>

    <span class="s2">&quot;ExternalFeature&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;Weather&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">time</span><span class="p">,</span> <span class="n">weather</span><span class="o">-</span><span class="n">feature</span><span class="o">-</span><span class="n">dim</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="use-datasets-from-urban-datasets">
<h3><span class="section-number">3.2.2. </span>Use datasets from Urban Datasets<a class="headerlink" href="#use-datasets-from-urban-datasets" title="Permalink to this heading">¶</a></h3>
<p>In this section, we will introduce how to get the dataset from Urban_Dataset and read the dataset using python.</p>
<p>You are proposed to download the zip file from the <a class="reference external" href="https://github.com/uctb/Urban-Dataset/blob/main/Public_Datasets/Pedestrian/60_minutes/Pedestrian_Melbourne.pkl.zip">link</a> and unzip the file. Let’s say the following scripts are placed at the same directory with the dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pkl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;Pedestrian_Melbourne.pkl&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pkl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
<p>Take a look at the necessary information about the dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Traffic data </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data time range&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TimeRange&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Traffic data shape:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">][</span><span class="s1">&#39;TrafficNode&#39;</span><span class="p">]))</span>
<span class="c1"># The first dimension of data[&#39;Node&#39;][&#39;TrafficNode&#39;] is the length of time-sequence.</span>
<span class="c1"># The second dimension is the number of stations.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time fitness:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;TimeFitness&#39;</span><span class="p">],</span> <span class="s1">&#39;minutes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Time sequence length:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">][</span><span class="s1">&#39;TrafficNode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of stations:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">][</span><span class="s1">&#39;TrafficNode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Data</span> <span class="n">time</span> <span class="nb">range</span> <span class="p">[</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-11-01&#39;</span><span class="p">]</span>
<span class="n">Traffic</span> <span class="n">data</span> <span class="n">shape</span><span class="p">:</span> <span class="p">(</span><span class="mi">16056</span><span class="p">,</span> <span class="mi">55</span><span class="p">)</span>
<span class="n">Time</span> <span class="n">fitness</span><span class="p">:</span> <span class="mi">60</span> <span class="n">minutes</span>
<span class="n">Time</span> <span class="n">sequence</span> <span class="n">length</span><span class="p">:</span> <span class="mi">16056</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">55</span>
</pre></div>
</div>
<p>Visualize the distribution of the traffic data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">][</span><span class="s1">&#39;TrafficNode&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="png" src="../_images/toturial_p1_dataplot.png" /></p>
</section>
</section>
<section id="how-to-get-the-datasets-at-other-granularities">
<h2><span class="section-number">3.3. </span>How to get the datasets at other granularities?<a class="headerlink" href="#how-to-get-the-datasets-at-other-granularities" title="Permalink to this heading">¶</a></h2>
<p>We could merge the fine-grained data to obtain the datasets at other granularities (e.g., by summing the 12 flows from the 5-minutes datasets to obtain 60-minutes datasets). UCTB provides the API to merge data. You could specify MergeIndex and MergeWay in the NodeTrafficLoader and GridTrafficLoader. Here is an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">UCTB.dataset</span> <span class="kn">import</span> <span class="n">NodeTrafficLoader</span>

<span class="c1"># loading 5-minutes datasets</span>

<span class="n">data_loader</span> <span class="o">=</span> <span class="n">NodeTrafficLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Bike&quot;</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s2">&quot;NYC&quot;</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">data_loader</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">node_traffic</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># with shape (446976, 820)</span>

<span class="n">data_loader</span> <span class="o">=</span> <span class="n">NodeTrafficLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Bike&quot;</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s2">&quot;NYC&quot;</span><span class="p">,</span> <span class="n">MergeIndex</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">MergeWay</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_loader</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">node_traffic</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># with shape (37248, 820)</span>
</pre></div>
</div>
</section>
<section id="build-your-own-datasets">
<h2><span class="section-number">3.4. </span>Build your own datasets<a class="headerlink" href="#build-your-own-datasets" title="Permalink to this heading">¶</a></h2>
<p>If you want to apply uctb dataloaders to your dataset, make your dataset compatible with the template as section 3.2.1 shown. And then save it with package <code class="docutils literal notranslate"><span class="pre">pickle</span></code> to a local path <code class="docutils literal notranslate"><span class="pre">pkl_file_name</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="n">pkl_file_name</span> <span class="o">=</span> <span class="s1">&#39;./my_dataset.pkl&#39;</span>  
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_file_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">my_dataset</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, you can make uses of your dataset by UCTB’s loader APIs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_loader</span> <span class="o">=</span> <span class="n">NodeTrafficLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">pkl_file_name</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, we provide interface to help build your own dataset, through which we clarify whether a field is necessary or optional when building a UCTB dataset.</p>
<p>To build a UCTB dataset, it is necessary to provide variables listed as below.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: left;">Variable_name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">time_fitness</td>
<td style="text-align: left;">The length of the interval between adjacent slots</td>
</tr>
<tr>
<td style="text-align: left;">time_range</td>
<td style="text-align: left;">The time interval at the beginning and end of the data</td>
</tr>
<tr>
<td style="text-align: left;">traffic_node</td>
<td style="text-align: left;">The spatio-temporal information</td>
</tr>
<tr>
<td style="text-align: left;">node_satation_info</td>
<td style="text-align: left;">The basic information of each data collecting node</td>
</tr>
<tr>
<td style="text-align: left;">dataset_name</td>
<td style="text-align: left;">Name of the dataset</td>
</tr>
<tr>
<td style="text-align: left;">city</td>
<td style="text-align: left;">A variable used to integrate holiday and weather information to traffic data</td>
</tr>
</tbody>
</table><p>Then, use the specified path to save the dataset, otherwise it will be saved in the current run-time path.</p>
<p>Although it’s diffcult to form an integrated function to include all situation you may meet during the transforming process, there are some procedures you might obey to simplify the data preprocessing.</p>
<ul class="simple">
<li><p>Data preprocessing</p>
<ol class="simple">
<li><p>Zero values</p></li>
<li><p>Missing values(NA)</p></li>
<li><p>Unknown values</p></li>
<li><p>Abnormal values</p></li>
<li><p>duplicates</p></li>
<li><p>Statistics(station number and time slots)</p></li>
</ol>
</li>
<li><p>Dictionary building</p>
<ul>
<li><p>Basic information(time range and time fitness)</p></li>
<li><p>Traffic node building</p>
<ul>
<li><p>Spatio-temporal raster data building</p>
<ol class="simple">
<li><p>Initialization</p></li>
<li><p>iterate raw data table and fill the matrix</p></li>
</ol>
</li>
<li><p>Station information</p></li>
</ul>
</li>
<li><p>Traffic grid building</p></li>
<li><p>External feature</p></li>
</ul>
</li>
</ul>
<p>Now, we assume that you have already finished variable preparation. UCTB provide API to assist you with dataset building.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">build_uctb_dataset</span><span class="p">(</span><span class="n">traffic_node</span><span class="o">=</span><span class="n">traffic_node</span><span class="p">,</span> <span class="n">time_fitness</span><span class="o">=</span><span class="n">time_fitness</span><span class="p">,</span> 
                <span class="n">node_station_info</span><span class="o">=</span><span class="n">node_station_info</span><span class="p">,</span> <span class="n">time_range</span><span class="o">=</span><span class="n">time_range</span><span class="p">,</span> 
                <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;tmp_dir&#39;</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;dataset&#39;</span><span class="p">,</span> <span class="n">city</span> <span class="o">=</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, if you want to check what fields are in your datasets, set the argument <code class="docutils literal notranslate"><span class="pre">print_dataset</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">build_uctb_dataset</span><span class="p">(</span><span class="n">traffic_node</span><span class="o">=</span><span class="n">traffic_node</span><span class="p">,</span> <span class="n">time_fitness</span><span class="o">=</span><span class="n">time_fitness</span><span class="p">,</span> 
                <span class="n">node_station_info</span><span class="o">=</span><span class="n">node_station_info</span><span class="p">,</span> <span class="n">time_range</span><span class="o">=</span><span class="n">time_range</span><span class="p">,</span> 
                <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;tmp_dir&#39;</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;dataset&#39;</span><span class="p">,</span> <span class="n">city</span> <span class="o">=</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> <span class="n">print_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dataset[TimeRange]:&lt;class &#39;list&#39;&gt;  (len=2)
dataset[TimeFitness]:&lt;class &#39;int&#39;&gt;
dataset[Node]:&lt;class &#39;dict&#39;&gt;{
    dataset[Node][TrafficNode]:&lt;class &#39;numpy.ndarray&#39;&gt;  (shape=(37248, 532))
    dataset[Node][StationInfo]:&lt;class &#39;list&#39;&gt;  (len=(532, 5))
    dataset[Node][TrafficMonthlyInteraction]:&lt;class &#39;NoneType&#39;&gt;
}
dataset[Grid]:&lt;class &#39;dict&#39;&gt;{
    dataset[Grid][TrafficGrid]:&lt;class &#39;NoneType&#39;&gt;
    dataset[Grid][GridLatLng]:&lt;class &#39;NoneType&#39;&gt;
}
dataset[ExternalFeature]:&lt;class &#39;dict&#39;&gt;{
    dataset[ExternalFeature][Weather]:&lt;class &#39;list&#39;&gt;  (len=0)
}
dataset[LenTimeSlots]:&lt;class &#39;int&#39;&gt;
</pre></div>
</div>
<p>What’s more, if you want to integrate additional information of the dataset, just specify the optional argument as bellow.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th style="text-align: left;">Variable_name</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">traffic_monthly_interaction</td>
<td style="text-align: left;">The interactive information among data collecting nodes.</td>
</tr>
<tr>
<td style="text-align: left;">node_poi</td>
<td style="text-align: left;">Point of interests conformed with node format</td>
</tr>
<tr>
<td style="text-align: left;">grid_poi</td>
<td style="text-align: left;">Point of interests conformed with grid format</td>
</tr>
<tr>
<td style="text-align: left;">traffic_grid</td>
<td style="text-align: left;">The spatio-temporal information in grid format.</td>
</tr>
<tr>
<td style="text-align: left;">gird_lat_lng</td>
<td style="text-align: left;">The basic information of each data collecting grid.</td>
</tr>
<tr>
<td style="text-align: left;">external_feature_weather</td>
<td style="text-align: left;">The weather information of each day.</td>
</tr>
</tbody>
</table><p>for example, specify the argument <code class="docutils literal notranslate"><span class="pre">external_feature_weather</span></code> with numpy.array object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">build_uctb_dataset</span><span class="p">(</span><span class="n">traffic_node</span><span class="o">=</span><span class="n">traffic_node</span><span class="p">,</span> <span class="n">time_fitness</span><span class="o">=</span><span class="n">time_fitness</span><span class="p">,</span> 
                <span class="n">node_station_info</span><span class="o">=</span><span class="n">node_station_info</span><span class="p">,</span> <span class="n">time_range</span><span class="o">=</span><span class="n">time_range</span><span class="p">,</span> 
                <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;tmp_dir&#39;</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="s1">&#39;dataset&#39;</span><span class="p">,</span> <span class="n">city</span> <span class="o">=</span> <span class="s1">&#39;Chicago&#39;</span><span class="p">,</span> 
                <span class="n">print_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">external_feature_weather</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">37248</span><span class="p">,</span><span class="mi">26</span><span class="p">]))</span>
</pre></div>
</div>
<p>The code above use zero matrix to specify the argument <code class="docutils literal notranslate"><span class="pre">external_feature_weather</span></code>. While in practical application scenario, you should substitute it with real feather matrix. The first dimension of the matrx is the number of time slots, and the second dimension corresponds to the dimension of weather features.</p>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="predictive_tool.html" class="btn btn-neutral float-right" title="4. Predictive Tool" accesskey="n">Next →</a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="2. Installation" accesskey="p">← Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, UCTB group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE: 'true'
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>