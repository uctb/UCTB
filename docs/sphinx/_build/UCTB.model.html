

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6.4. UCTB.model package &mdash; UCTB  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="UCTB  documentation" href="index.html"/>
        <link rel="up" title="6. API Reference" href="APIReference.html"/>
        <link rel="next" title="6.5. UCTB.evaluation package" href="UCTB.evaluation.html"/>
        <link rel="prev" title="6.3. UCTB.model_unit package" href="UCTB.model_unit.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> UCTB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="md_file/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/urban_dataset.html">3. Urban Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/predictive_tool.html">4. Predictive Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/visualization_tool.html">5. Visualization-tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="APIReference.html">6. API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/all_results.html">7. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/uctb_group.html">8. About us (UCTB Group)</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UCTB</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="APIReference.html">6. API Reference</a> &raquo;</li>
        
      <li>6.4. UCTB.model package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/UCTB.model.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uctb-model-package">
<h1>6.4. UCTB.model package<a class="headerlink" href="#uctb-model-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-UCTB.model.ARIMA">
<span id="uctb-model-arima-module"></span><h2>6.4.1. UCTB.model.ARIMA module<a class="headerlink" href="#module-UCTB.model.ARIMA" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.ARIMA.ARIMA">
<em class="property">class </em><code class="descclassname">UCTB.model.ARIMA.</code><code class="descname">ARIMA</code><span class="sig-paren">(</span><em>time_sequence</em>, <em>order=None</em>, <em>seasonal_order=(0</em>, <em>0</em>, <em>0</em>, <em>0)</em>, <em>max_ar=6</em>, <em>max_ma=4</em>, <em>max_d=2</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ARIMA.ARIMA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>ARIMA is a generalization of an ARMA (Autoregressive Moving Average) model, used in predicting
future points in time series analysis.</p>
<p>Since there may be three kinds of series data as closeness, period and trend history, this class
trains three different ARIMA models for each node according  to the three kinds of history data,
and returns average of the predicted values by the models in prediction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time_sequence</strong> (<em>array_like</em>) – The observation value of time_series.</li>
<li><strong>order</strong> (<em>iterable</em>) – It stores the (p, d, q) orders of the model for the number of AR parameters
, differences, MA parameters. If set to None, ARIMA class will calculate the orders for
each series based on max_ar, max_ma and max_d. Default: None</li>
<li><strong>seasonal_order</strong> (<em>iterable</em>) – It stores the (P,D,Q,s) order of the seasonal ARIMA model for the
AR parameters, differences, MA parameters, and periodicity. <cite>s</cite> is an integer giving the
periodicity (number of periods in season).</li>
<li><strong>max_ar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Maximum number of AR lags to use. Default: 6</li>
<li><strong>max_ma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Maximum number of MA lags to use. Default: 4</li>
<li><strong>max_d</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Maximum number of degrees of differencing. Default: 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Attribute:</dt>
<dd>order(iterable): (p, d, q) orders for ARIMA model.
seasonal_order(iterable): (P,D,Q,s) order for seasonal ARIMA model.
model_res(): Fit method for likelihood based models.</dd>
</dl>
<dl class="staticmethod">
<dt id="UCTB.model.ARIMA.ARIMA.adf_test">
<em class="property">static </em><code class="descname">adf_test</code><span class="sig-paren">(</span><em>time_series</em>, <em>max_lags=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ARIMA.ARIMA.adf_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Augmented Dickey–Fuller test. The Augmented Dickey-Fuller test can be used to test for
a unit root in a univariate process in the presence of serial correlation.</p>
</dd></dl>

<dl class="method">
<dt id="UCTB.model.ARIMA.ARIMA.get_order">
<code class="descname">get_order</code><span class="sig-paren">(</span><em>series</em>, <em>order=None</em>, <em>max_ar=6</em>, <em>max_ma=2</em>, <em>max_d=2</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ARIMA.ARIMA.get_order" title="Permalink to this definition">¶</a></dt>
<dd><p>If order is None, it simply returns order, otherwise, it calculates the (p, d, q) orders
for the series data based on max_ar, max_ma and max_d.</p>
</dd></dl>

<dl class="method">
<dt id="UCTB.model.ARIMA.ARIMA.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>time_sequences</em>, <em>forecast_step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ARIMA.ARIMA.predict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Argues:</dt>
<dd>time_sequences: The input time_series features.
forecast_step: The number of predicted future steps. Default: 1</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Prediction results with shape of (len(time_sequence)/forecast_step,forecast_step=,1).</td>
</tr>
<tr class="field-even field"><th class="field-name">Type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.DCRNN">
<span id="uctb-model-dcrnn-module"></span><h2>6.4.2. UCTB.model.DCRNN module<a class="headerlink" href="#module-UCTB.model.DCRNN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.DCRNN.DCRNN">
<em class="property">class </em><code class="descclassname">UCTB.model.DCRNN.</code><code class="descname">DCRNN</code><span class="sig-paren">(</span><em>num_node</em>, <em>num_diffusion_matrix</em>, <em>num_rnn_units=64</em>, <em>num_rnn_layers=1</em>, <em>max_diffusion_step=2</em>, <em>seq_len=6</em>, <em>use_curriculum_learning=False</em>, <em>input_dim=1</em>, <em>output_dim=1</em>, <em>cl_decay_steps=1000</em>, <em>target_len=1</em>, <em>lr=0.0001</em>, <em>epsilon=0.001</em>, <em>optimizer_name='Adam'</em>, <em>code_version='DCRNN-QuickStart'</em>, <em>model_dir='model_dir'</em>, <em>gpu_device='0'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.DCRNN.DCRNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/pdf/1707.01926.pdf">Diffusion convolutional recurrent neural network: Data-driven traffic forecasting (Li Yaguang, et al., 2017)</a>.</li>
<li><a class="reference external" href="https://github.com/liyaguang/DCRNN">A TensorFlow implementation of Diffusion Convolutional Recurrent Neural Network (liyaguang)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of nodes in the graph, e.g. number of stations in NYC-Bike dataset.</li>
<li><strong>num_diffusion_matrix</strong> – Number of diffusion matrix used in model.</li>
<li><strong>num_rnn_units</strong> – Number of RNN units.</li>
<li><strong>num_rnn_layers</strong> – Number of RNN layers</li>
<li><strong>max_diffusion_step</strong> – Number of diffusion steps</li>
<li><strong>seq_len</strong> – Input sequence length</li>
<li><strong>use_curriculum_learning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – model’s prediction (True) or the previous ground truth in training (False).</li>
<li><strong>input_dim</strong> – Dimension of the input feature</li>
<li><strong>output_dim</strong> – Dimension of the output feature</li>
<li><strong>cl_decay_steps</strong> – When use_curriculum_learning=True, cl_decay_steps is used to adjust the ratio of using ground
true labels, where with more training steps, the ratio drops.</li>
<li><strong>target_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Output sequence length.</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate</li>
<li><strong>epsilon</strong> – epsilon in Adam</li>
<li><strong>optimizer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – ‘sgd’ or ‘Adam’ optimizer</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code, which will be used as filename for saving the model</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’.</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.DCRNN.DCRNN.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>init_vars=True</em>, <em>max_to_keep=5</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.DCRNN.DCRNN.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.DeepST">
<span id="uctb-model-deepst-module"></span><h2>6.4.3. UCTB.model.DeepST module<a class="headerlink" href="#module-UCTB.model.DeepST" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.DeepST.DeepST">
<em class="property">class </em><code class="descclassname">UCTB.model.DeepST.</code><code class="descname">DeepST</code><span class="sig-paren">(</span><em>closeness_len</em>, <em>period_len</em>, <em>trend_len</em>, <em>width</em>, <em>height</em>, <em>external_dim</em>, <em>kernel_size=3</em>, <em>num_conv_filters=64</em>, <em>lr=1e-05</em>, <em>code_version='QuickStart-DeepST'</em>, <em>model_dir='model_dir'</em>, <em>gpu_device='0'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.DeepST.DeepST" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<p>Deep learning-based prediction model for Spatial-Temporal data (DeepST)</p>
<p>DeepST is composed of three components: 1) temporal dependent
instances: describing temporal closeness, period and seasonal
trend; 2) convolutional neural networks: capturing near and
far spatial dependencies; 3) early and late fusions: fusing
similar and different domains’ data.</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/09/DeepST-SIGSPATIAL2016.pdf">DNN-Based Prediction Model for Spatial-Temporal Data (Junbo Zhang et al., 2016)</a>.</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>closeness_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of closeness data history. The former consecutive <code class="docutils literal"><span class="pre">closeness_len</span></code> time slots
of data will be used as closeness history.</li>
<li><strong>period_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of period data history. The data of exact same time slots in former consecutive
<code class="docutils literal"><span class="pre">period_len</span></code> days will be used as period history.</li>
<li><strong>trend_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of trend data history. The data of exact same time slots in former consecutive
<code class="docutils literal"><span class="pre">trend_len</span></code> weeks (every seven days) will be used as trend history.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The width of grid data.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The height of grid data.</li>
<li><strong>externai_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dimensions of external data.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Kernel size in Convolutional neural networks. Default: 3</li>
<li><strong>num_conv_filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the Number of filters in the convolution. Default: 64</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate. Default: 1e-5</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code.</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.DeepST.DeepST.build">
<code class="descname">build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.DeepST.DeepST.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.GeoMAN">
<span id="uctb-model-geoman-module"></span><h2>6.4.4. UCTB.model.GeoMAN module<a class="headerlink" href="#module-UCTB.model.GeoMAN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.GeoMAN.GeoMAN">
<em class="property">class </em><code class="descclassname">UCTB.model.GeoMAN.</code><code class="descname">GeoMAN</code><span class="sig-paren">(</span><em>total_sensers</em>, <em>input_dim</em>, <em>external_dim</em>, <em>output_dim</em>, <em>input_steps</em>, <em>output_steps</em>, <em>n_stacked_layers=2</em>, <em>n_encoder_hidden_units=128</em>, <em>n_decoder_hidden_units=128</em>, <em>dropout_rate=0.3</em>, <em>lr=0.001</em>, <em>gc_rate=2.5</em>, <em>code_version='GeoMAN-QuickStart'</em>, <em>model_dir='model_dir'</em>, <em>gpu_device='0'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GeoMAN.GeoMAN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<p>Multi-level Attention Networks for Geo-sensory Time Series Prediction (GeoMAN)</p>
<p>GeoMAN consists of two major parts: 1) A multi-level attention mechanism (including both local and global
spatial attentions in encoder and temporal attention in decoder) to model the dynamic spatio-temporal
dependencies; 2) A general fusion module to incorporate the external factors from different domains (e.g.,
meteorology, time of day and land use).</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://www.ijcai.org/proceedings/2018/0476.pdf">GeoMAN: Multi-level Attention Networks for Geo-sensory Time Series Prediction (Liang Yuxuan, et al., 2018)</a>.</li>
<li><a class="reference external" href="https://github.com/yoshall/GeoMAN">An easy implement of GeoMAN using TensorFlow (yoshall &amp; CastleLiang)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>total_sensers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of total sensors used in global attention mechanism.</li>
<li><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of dimensions of the target sensor’s input.</li>
<li><strong>external_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of dimensions of the external features.</li>
<li><strong>output_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of dimensions of the target sensor’s output.</li>
<li><strong>input_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of historical input data, a.k.a, input timesteps.</li>
<li><strong>output_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of steps that need prediction by one piece of history data, a.k.a, output
timesteps. Have to be 1 now.</li>
<li><strong>n_stacked_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of LSTM layers stacked in both encoder and decoder (These two are the
same). Default: 2</li>
<li><strong>n_encoder_hidden_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of hidden units in each layer of encoder. Default: 128</li>
<li><strong>n_decoder_hidden_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of hidden units in each layer of decoder. Default: 128</li>
<li><strong>dropout_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Dropout rate of LSTM layers in both encoder and decoder. Default: 0.3</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate. Default: 0.001</li>
<li><strong>gc_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – A clipping ratio for all the gradients. This operation normalizes all gradients so that
their L2-norms are less than or equal to <code class="docutils literal"><span class="pre">gc_rate</span></code>. Default: 2.5</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code. Default: ‘GeoMAN-QuickStart’</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’</li>
<li><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – Reserved for future use. May be used to pass parameters to class <code class="docutils literal"><span class="pre">BaseModel</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.GeoMAN.GeoMAN.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>init_vars=True</em>, <em>max_to_keep=5</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GeoMAN.GeoMAN.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="UCTB.model.GeoMAN.input_transform">
<code class="descclassname">UCTB.model.GeoMAN.</code><code class="descname">input_transform</code><span class="sig-paren">(</span><em>local_features</em>, <em>global_features</em>, <em>external_features</em>, <em>targets</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GeoMAN.input_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the model’s inputs from matrices to lists on timesteps axis.</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GeoMAN.split_timesteps">
<code class="descclassname">UCTB.model.GeoMAN.</code><code class="descname">split_timesteps</code><span class="sig-paren">(</span><em>inputs</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GeoMAN.split_timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the input matrix from (batch, timesteps, input_dim) to a step list ([[batch, input_dim], …, ]).</p>
</dd></dl>

</div>
<div class="section" id="module-UCTB.model.HM">
<span id="uctb-model-hm-module"></span><h2>6.4.5. UCTB.model.HM module<a class="headerlink" href="#module-UCTB.model.HM" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.HM.HM">
<em class="property">class </em><code class="descclassname">UCTB.model.HM.</code><code class="descname">HM</code><span class="sig-paren">(</span><em>c</em>, <em>p</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.HM.HM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Historical Mean. A naive method that simply return average of hisrory data of each time slot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of time slots of closeness history.</li>
<li><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of time slots of period history which presents daily feature.</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of time slots of trend history which presents weekly feature.</li>
<li><strong>that `</strong> (<em>Note</em>) – </li>
<li><strong>should be considerd in average.</strong> (<em>features</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.HM.HM.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>closeness_feature</em>, <em>period_feature</em>, <em>trend_feature</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.HM.HM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Give closeness, period and trend history values and then use their averages as predict.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.STMeta">
<span id="uctb-model-stmeta-module"></span><h2>6.4.6. UCTB.model.STMeta module<a class="headerlink" href="#module-UCTB.model.STMeta" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.STMeta.STMeta">
<em class="property">class </em><code class="descclassname">UCTB.model.STMeta.</code><code class="descname">STMeta</code><span class="sig-paren">(</span><em>num_node</em>, <em>external_dim</em>, <em>closeness_len</em>, <em>period_len</em>, <em>trend_len</em>, <em>input_dim=1</em>, <em>num_graph=1</em>, <em>gcn_k=1</em>, <em>gcn_layers=1</em>, <em>gclstm_layers=1</em>, <em>num_hidden_units=64</em>, <em>num_dense_units=32</em>, <em>graph_merge_gal_units=32</em>, <em>graph_merge_gal_num_heads=2</em>, <em>temporal_merge_gal_units=64</em>, <em>temporal_merge_gal_num_heads=2</em>, <em>st_method='GCLSTM'</em>, <em>temporal_merge='gal'</em>, <em>graph_merge='gal'</em>, <em>output_activation=&lt;function sigmoid&gt;</em>, <em>lr=0.0001</em>, <em>code_version='STMeta-QuickStart'</em>, <em>model_dir='model_dir'</em>, <em>gpu_device='0'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STMeta.STMeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of nodes in the graph, e.g. number of stations in NYC-Bike dataset.</li>
<li><strong>external_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Dimension of the external feature, e.g. temperature and wind are two dimension.</li>
<li><strong>closeness_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of closeness data history. The former consecutive <code class="docutils literal"><span class="pre">closeness_len</span></code> time slots</li>
<li><strong>data will be used as closeness history.</strong> (<em>of</em>) – </li>
<li><strong>period_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of period data history. The data of exact same time slots in former consecutive</li>
<li><strong>days will be used as period history.</strong> (<em>period_len</em>) – </li>
<li><strong>trend_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of trend data history. The data of exact same time slots in former consecutive</li>
<li><strong>weeks</strong> (<em>trend_len</em>) – </li>
<li><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The dimension of input features. 1 if “with_tpe” (data_loader parameters) = False, otherwise 0.</li>
<li><strong>num_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of graphs used in STMeta.</li>
<li><strong>gcn_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The highest order of Chebyshev Polynomial approximation in GCN.</li>
<li><strong>gcn_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of GCN layers.</li>
<li><strong>gclstm_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of STRNN layers, it works on all modes of STMeta such as GCLSTM and DCRNN.</li>
<li><strong>num_hidden_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of hidden units of RNN.</li>
<li><strong>num_dense_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dense units.</li>
<li><strong>graph_merge_gal_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of units in GAL for merging different graph features.
Only works when graph_merge=’gal’</li>
<li><strong>graph_merge_gal_num_heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of heads in GAL for merging different graph features.
Only works when graph_merge=’gal’</li>
<li><strong>temporal_merge_gal_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of units in GAL for merging different temporal features.
Only works when temporal_merge=’gal’</li>
<li><strong>temporal_merge_gal_num_heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of heads in GAL for merging different temporal features.
Only works when temporal_merge=’gal’</li>
<li><strong>st_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – must in [‘GCLSTM’, ‘DCRNN’, ‘GRU’, ‘LSTM’], which refers to different
spatial-temporal modeling methods.
‘GCLSTM’: GCN for modeling spatial feature, LSTM for modeling temporal feature.
‘DCRNN’: Diffusion Convolution for modeling spatial feature, GRU for modeling temporam frature.
‘GRU’: Ignore the spatial, and model the temporal feature using GRU
‘LSTM’: Ignore the spatial, and model the temporal feature using LSTM</li>
<li><strong>temporal_merge</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – must in [‘gal’, ‘concat’], refers to different temporal merging methods,
‘gal’: merge using GAL,
‘concat’: merge by concat and dense</li>
<li><strong>graph_merge</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – must in [‘gal’, ‘concat’], refers to different graph merging methods,
‘gal’: merge using GAL,
‘concat’: merge by concat and dense</li>
<li><strong>output_activation</strong> (<em>function</em>) – activation function, e.g. tf.nn.tanh</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate. Default: 1e-5</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code, which will be used as filename for saving the model</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’.</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.STMeta.STMeta.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>init_vars=True</em>, <em>max_to_keep=5</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STMeta.STMeta.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.ST_MGCN">
<span id="uctb-model-st-mgcn-module"></span><h2>6.4.7. UCTB.model.ST_MGCN module<a class="headerlink" href="#module-UCTB.model.ST_MGCN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.ST_MGCN.ST_MGCN">
<em class="property">class </em><code class="descclassname">UCTB.model.ST_MGCN.</code><code class="descname">ST_MGCN</code><span class="sig-paren">(</span><em>T</em>, <em>input_dim</em>, <em>num_graph</em>, <em>gcl_k</em>, <em>gcl_l</em>, <em>lstm_units</em>, <em>lstm_layers</em>, <em>lr</em>, <em>external_dim</em>, <em>code_version</em>, <em>model_dir</em>, <em>gpu_device</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ST_MGCN.ST_MGCN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="http://www-scf.usc.edu/~yaguang/papers/aaai19_multi_graph_convolution.pdf">Spatiotemporal multi-graph convolution network for ride-hailing demand forecasting (Geng Xu, et al., 2019)</a>.</li>
<li><a class="reference external" href="https://github.com/shawnwang-tech/ST-MGCN-pytorch">A PyTorch implementation of the ST-MGCN model  (shawnwang-tech)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Input sequence length</li>
<li><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Input feature dimension</li>
<li><strong>num_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of graphs used in the model.</li>
<li><strong>gcl_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The highest order of Chebyshev Polynomial approximation in GCN.</li>
<li><strong>gcl_l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of GCN layers.</li>
<li><strong>lstm_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of hidden units of RNN.</li>
<li><strong>lstm_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of LSTM layers.</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate</li>
<li><strong>external_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Dimension of the external feature, e.g. temperature and wind are two dimension.</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code, which will be used as filename for saving the model</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’.</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.ST_MGCN.ST_MGCN.build">
<code class="descname">build</code><span class="sig-paren">(</span><em>init_vars=True</em>, <em>max_to_keep=5</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ST_MGCN.ST_MGCN.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.ST_ResNet">
<span id="uctb-model-st-resnet-module"></span><h2>6.4.8. UCTB.model.ST_ResNet module<a class="headerlink" href="#module-UCTB.model.ST_ResNet" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.ST_ResNet.ST_ResNet">
<em class="property">class </em><code class="descclassname">UCTB.model.ST_ResNet.</code><code class="descname">ST_ResNet</code><span class="sig-paren">(</span><em>width</em>, <em>height</em>, <em>external_dim</em>, <em>closeness_len</em>, <em>period_len</em>, <em>trend_len</em>, <em>num_residual_unit=4</em>, <em>kernel_size=3</em>, <em>lr=5e-05</em>, <em>model_dir='model_dir'</em>, <em>code_version='QuickStart'</em>, <em>conv_filters=64</em>, <em>gpu_device='0'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ST_ResNet.ST_ResNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="UCTB.model_unit.html#UCTB.model_unit.BaseModel.BaseModel" title="UCTB.model_unit.BaseModel.BaseModel"><code class="xref py py-class docutils literal"><span class="pre">UCTB.model_unit.BaseModel.BaseModel</span></code></a></p>
<p>ST-ResNet is a deep-learning model with an end-to-end structure
based on unique properties of spatio-temporal data making use of convolution and residual units.</p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://arxiv.org/pdf/1610.00081.pdf">Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows Prediction (Junbo Zhang et al., 2016)</a>.</li>
<li><a class="reference external" href="https://github.com/lucktroy/DeepST/tree/master/scripts/papers/AAAI17">Github repository (lucktroy)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The width of grid data.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The height of grid data.</li>
<li><strong>externai_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dimensions of external data.</li>
<li><strong>closeness_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of closeness data history. The former consecutive <code class="docutils literal"><span class="pre">closeness_len</span></code> time slots
of data will be used as closeness history.</li>
<li><strong>period_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of period data history. The data of exact same time slots in former consecutive
<code class="docutils literal"><span class="pre">period_len</span></code> days will be used as period history.</li>
<li><strong>trend_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of trend data history. The data of exact same time slots in former consecutive
<code class="docutils literal"><span class="pre">trend_len</span></code> weeks (every seven days) will be used as trend history.</li>
<li><strong>num_residual_unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of residual units. Default: 4</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Kernel size in Convolutional neural networks. Default: 3</li>
<li><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Learning rate. Default: 1e-5</li>
<li><strong>code_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Current version of this model code.</li>
<li><strong>model_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The directory to store model files. Default:’model_dir’</li>
<li><strong>conv_filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the Number of filters in the convolution. Default: 64</li>
<li><strong>gpu_device</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – To specify the GPU to use. Default: ‘0’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.ST_ResNet.ST_ResNet.build">
<code class="descname">build</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ST_ResNet.ST_ResNet.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.XGBoost">
<span id="uctb-model-xgboost-module"></span><h2>6.4.9. UCTB.model.XGBoost module<a class="headerlink" href="#module-UCTB.model.XGBoost" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.XGBoost.XGBoost">
<em class="property">class </em><code class="descclassname">UCTB.model.XGBoost.</code><code class="descname">XGBoost</code><span class="sig-paren">(</span><em>n_estimators=10</em>, <em>max_depth=5</em>, <em>verbosity=0</em>, <em>objective='reg:squarederror'</em>, <em>eval_metric='rmse'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.XGBoost.XGBoost" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>XGBoost is an optimized distributed gradient boosting machine learning algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>*n_estimators</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of boosting iterations. Default: 10</li>
<li><strong>*max_depth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Maximum tree depth for base learners. Default: 5</li>
<li><strong>*verbosity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The degree of verbosity. Valid values are 0 (silent) - 3 (debug). Default: 0</li>
<li><strong>*objective</strong> (<a class="reference external" href="https://docs.python.org/3/library/string.html#module-string" title="(in Python v3.12)"><em>string</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.12)"><em>callable</em></a>) – Specify the learning task and the corresponding learning objective or
a custom objective function to be used. Default: <code class="docutils literal"><span class="pre">'reg:squarederror'</span></code></li>
<li><strong>*eval_metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>list of str</em><em>, or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.12)"><em>callable</em></a><em>, </em><em>optional</em>) – If a str, should be a built-in evaluation metric to use. See more in
<a class="reference external" href="https://xgboost.readthedocs.io/en/latest/python/python_api.html">API Reference of XGBoost Library</a>.
Default: <code class="docutils literal"><span class="pre">'rmse'</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.XGBoost.XGBoost.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.XGBoost.XGBoost.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Training method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>np.ndarray/scipy.sparse/pd.DataFrame/dt.Frame</em>) – The training input samples.</li>
<li><strong>y</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – The target values of training samples.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="UCTB.model.XGBoost.XGBoost.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.XGBoost.XGBoost.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Prediction method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Predicted values with shape as [time_slot_num, node_num, 1].</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-UCTB.model.AGCRN">
<span id="uctb-model-agcrn-module"></span><h2>6.4.10. UCTB.model.AGCRN module<a class="headerlink" href="#module-UCTB.model.AGCRN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.AGCRN.AGCRN">
<em class="property">class </em><code class="descclassname">UCTB.model.AGCRN.</code><code class="descname">AGCRN</code><span class="sig-paren">(</span><em>num_node</em>, <em>input_dim</em>, <em>hidden_dim</em>, <em>output_dim</em>, <em>pred_step</em>, <em>num_layers</em>, <em>default_graph</em>, <em>embed_dim</em>, <em>cheb_k</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.AGCRN.AGCRN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://proceedings.neurips.cc/paper/2020/file/ce1aad92b939420fc17005e5461e6f48-Paper.pdf">Adaptive graph convolutional recurrent network for traffic forecasting.</a>.</li>
<li><a class="reference external" href="https://github.com/LeiBAI/AGCRN">A PyTorch implementation of the AGCRN model  (LeiBAI)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of nodes.</li>
<li><strong>input_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Input feature dimension.</li>
<li><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of hidden units of RNN.</li>
<li><strong>output_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dimension of output.</li>
<li><strong>pred_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of steps to predict.</li>
<li><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of layers of AGCRNCell.</li>
<li><strong>default_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether to use default graph or not.</li>
<li><strong>embed_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of dimension of embedding.</li>
<li><strong>cheb_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Order of chebyshev polynomial.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-UCTB.model.ASTGCN">
<span id="uctb-model-astgcn-module"></span><h2>6.4.11. UCTB.model.ASTGCN module<a class="headerlink" href="#module-UCTB.model.ASTGCN" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="UCTB.model.ASTGCN.ASTGCN_submodule">
<em class="property">class </em><code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">ASTGCN_submodule</code><span class="sig-paren">(</span><em>DEVICE</em>, <em>num_blocks</em>, <em>in_channels</em>, <em>K</em>, <em>num_chev_filter</em>, <em>num_time_filter</em>, <em>time_strides</em>, <em>cheb_polynomials</em>, <em>pred_step</em>, <em>len_input</em>, <em>num_node</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.ASTGCN_submodule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://ojs.aaai.org/index.php/AAAI/article/view/3881">Attention based spatial-temporal graph convolutional networks for traffic flow forecasting..</a>.</li>
<li><a class="reference external" href="https://github.com/guoshnBJTU/ASTGCN-r-pytorch">A PyTorch implementation of the ASTGCN model  (guoshnBJTU)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>DEVICE</strong> (<em>torch.device</em>) – Which device use to train.</li>
<li><strong>num_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of blocks.</li>
<li><strong>in_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of input channels.</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Order of chebyshev polynomial.</li>
<li><strong>num_chev_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of chebyshev filter.</li>
<li><strong>num_time_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of time filter.</li>
<li><strong>time_strides</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of time strides.</li>
<li><strong>cheb_polynomials</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Chebyshev Polynomials.</li>
<li><strong>pred_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of steps of prediction.</li>
<li><strong>len_input</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of steps of sequence input.</li>
<li><strong>num_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of nodes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="UCTB.model.ASTGCN.ASTGCN_submodule.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.ASTGCN_submodule.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – (B, N_nodes, F_in, T_in)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(B, N_nodes, T_out)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="UCTB.model.ASTGCN.Spatial_Attention_layer">
<em class="property">class </em><code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">Spatial_Attention_layer</code><span class="sig-paren">(</span><em>DEVICE</em>, <em>in_channels</em>, <em>num_of_vertices</em>, <em>num_of_timesteps</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.Spatial_Attention_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>compute spatial attention scores</p>
<dl class="method">
<dt id="UCTB.model.ASTGCN.Spatial_Attention_layer.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.Spatial_Attention_layer.forward" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> – (batch_size, N, F_in, T)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(B,N,N)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="UCTB.model.ASTGCN.cheb_conv">
<em class="property">class </em><code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">cheb_conv</code><span class="sig-paren">(</span><em>K</em>, <em>cheb_polynomials</em>, <em>in_channels</em>, <em>out_channels</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.cheb_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>K-order chebyshev graph convolution</p>
<dl class="method">
<dt id="UCTB.model.ASTGCN.cheb_conv.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.cheb_conv.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Chebyshev graph convolution operation
:param x: (batch_size, N, F_in, T)
:return: (batch_size, N, F_out, T)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="UCTB.model.ASTGCN.cheb_conv_withSAt">
<em class="property">class </em><code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">cheb_conv_withSAt</code><span class="sig-paren">(</span><em>K</em>, <em>cheb_polynomials</em>, <em>in_channels</em>, <em>out_channels</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.cheb_conv_withSAt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>K-order chebyshev graph convolution</p>
<dl class="method">
<dt id="UCTB.model.ASTGCN.cheb_conv_withSAt.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>x</em>, <em>spatial_attention</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.cheb_conv_withSAt.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Chebyshev graph convolution operation
:param x: (batch_size, N, F_in, T)
:return: (batch_size, N, F_out, T)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="UCTB.model.ASTGCN.cheb_polynomial">
<code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">cheb_polynomial</code><span class="sig-paren">(</span><em>L_tilde</em>, <em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.cheb_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>compute a list of chebyshev polynomials from T_0 to T_{K-1}</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>L_tilde</strong> (<em>scaled Laplacian</em><em>, </em><em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>N</em><em>, </em><em>N</em><em>)</em>) – </li>
<li><strong>K</strong> (<em>the maximum order of chebyshev polynomials</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cheb_polynomials</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a>(np.ndarray), length: K, from T_0 to T_{K-1}</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.ASTGCN.make_model">
<code class="descclassname">UCTB.model.ASTGCN.</code><code class="descname">make_model</code><span class="sig-paren">(</span><em>DEVICE</em>, <em>nb_block</em>, <em>in_channels</em>, <em>K</em>, <em>nb_chev_filter</em>, <em>nb_time_filter</em>, <em>time_strides</em>, <em>L_tilde</em>, <em>num_for_predict</em>, <em>len_input</em>, <em>num_of_vertices</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.ASTGCN.make_model" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>DEVICE</strong> – </li>
<li><strong>nb_block</strong> – </li>
<li><strong>in_channels</strong> – </li>
<li><strong>K</strong> – </li>
<li><strong>nb_chev_filter</strong> – </li>
<li><strong>nb_time_filter</strong> – </li>
<li><strong>time_strides</strong> – </li>
<li><strong>cheb_polynomials</strong> – </li>
<li><strong>nb_predict_step</strong> – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>:param len_input
:return:</p>
</dd></dl>

</div>
<div class="section" id="module-UCTB.model.GMAN">
<span id="uctb-model-gman-module"></span><h2>6.4.12. UCTB.model.GMAN module<a class="headerlink" href="#module-UCTB.model.GMAN" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="UCTB.model.GMAN.GMAN">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">GMAN</code><span class="sig-paren">(</span><em>X</em>, <em>TE</em>, <em>SE</em>, <em>P</em>, <em>Q</em>, <em>T</em>, <em>L</em>, <em>K</em>, <em>d</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.GMAN" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>References:
- <a href="#id1"><span class="problematic" id="id2">`</span></a>Gman: A graph multi-attention network for traffic prediction.</p>
<blockquote>
<div>&lt;<a class="reference external" href="https://ojs.aaai.org/index.php/AAAI/article/view/5477">https://ojs.aaai.org/index.php/AAAI/article/view/5477</a>&gt;`_.</div></blockquote>
<ul class="simple">
<li><a class="reference external" href="https://github.com/zhengchuanpan/GMAN">A Tensorflow implementation of the GMAN model  (Zhengchuanpan)</a>.</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>P</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of history steps.</li>
<li><strong>Q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of prediction steps.</li>
<li><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of steps which one day is divided into.</li>
<li><strong>L</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of STAtt blocks in the encoder/decoder.</li>
<li><strong>K</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of attention heads.</li>
<li><strong>d</strong> – Number of dimension of each attention head outputs.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.STEmbedding">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">STEmbedding</code><span class="sig-paren">(</span><em>SE</em>, <em>TE</em>, <em>T</em>, <em>D</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.STEmbedding" title="Permalink to this definition">¶</a></dt>
<dd><p>spatio-temporal embedding</p>
<p>SE:      [N, D]
TE:      [batch_size, P + Q, 2] (dayofweek, timeofday)
T:        num of time steps in one day
D:        output dims
retrun: [batch_size, P + Q, N, D]</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.alias_draw">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">alias_draw</code><span class="sig-paren">(</span><em>J</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.alias_draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw sample from a non-uniform discrete distribution using alias sampling.</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.alias_setup">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">alias_setup</code><span class="sig-paren">(</span><em>probs</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.alias_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute utility lists for non-uniform sampling from discrete distributions.
Refer to <a class="reference external" href="https://hips.seas.harvard.edu/blog/2013/03/03/the-alias-method-efficient-sampling-with-many-discrete-outcomes/">https://hips.seas.harvard.edu/blog/2013/03/03/the-alias-method-efficient-sampling-with-many-discrete-outcomes/</a>
for details</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.gatedFusion">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">gatedFusion</code><span class="sig-paren">(</span><em>HS</em>, <em>HT</em>, <em>D</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.gatedFusion" title="Permalink to this definition">¶</a></dt>
<dd><p>gated fusion</p>
<p>HS:      [batch_size, num_step, N, D]
HT:      [batch_size, num_step, N, D]
D:        output dims
return: [batch_size, num_step, N, D]</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.spatialAttention">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">spatialAttention</code><span class="sig-paren">(</span><em>X</em>, <em>STE</em>, <em>K</em>, <em>d</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.spatialAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>spatial attention mechanism</p>
<p>X:        [batch_size, num_step, N, D]
STE:    [batch_size, num_step, N, D]
K:        number of attention heads
d:        dimension of each attention outputs
return: [batch_size, num_step, N, D]</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.temporalAttention">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">temporalAttention</code><span class="sig-paren">(</span><em>X</em>, <em>STE</em>, <em>K</em>, <em>d</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em>, <em>mask=True</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.temporalAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>temporal attention mechanism</p>
<p>X:        [batch_size, num_step, N, D]
STE:    [batch_size, num_step, N, D]
K:        number of attention heads
d:        dimension of each attention outputs
return: [batch_size, num_step, N, D]</p>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.GMAN.transformAttention">
<code class="descclassname">UCTB.model.GMAN.</code><code class="descname">transformAttention</code><span class="sig-paren">(</span><em>X</em>, <em>STE_P</em>, <em>STE_Q</em>, <em>K</em>, <em>d</em>, <em>bn</em>, <em>bn_decay</em>, <em>is_training</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GMAN.transformAttention" title="Permalink to this definition">¶</a></dt>
<dd><p>transform attention mechanism</p>
<p>X:        [batch_size, P, N, D]
STE_P:  [batch_size, P, N, D]
STE_Q:  [batch_size, Q, N, D]
K:        number of attention heads
d:        dimension of each attention outputs
return: [batch_size, Q, N, D]</p>
</dd></dl>

</div>
<div class="section" id="uctb-model-graphwavenet-module">
<h2>6.4.13. UCTB.model.GraphWaveNet module<a class="headerlink" href="#uctb-model-graphwavenet-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-UCTB.model.GraphWaveNet"></span><dl class="class">
<dt id="UCTB.model.GraphWaveNet.gwnet">
<em class="property">class </em><code class="descclassname">UCTB.model.GraphWaveNet.</code><code class="descname">gwnet</code><span class="sig-paren">(</span><em>device</em>, <em>num_node</em>, <em>dropout=0.3</em>, <em>supports=None</em>, <em>gcn_bool=True</em>, <em>addaptadj=True</em>, <em>aptinit=None</em>, <em>in_dim=2</em>, <em>out_dim=12</em>, <em>residual_channels=32</em>, <em>dilation_channels=32</em>, <em>skip_channels=256</em>, <em>end_channels=512</em>, <em>kernel_size=2</em>, <em>blocks=4</em>, <em>layers=2</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.GraphWaveNet.gwnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://www.ijcai.org/proceedings/2019/0264.pdf">Graph wavenet for deep spatial-temporal graph modeling.</a>.</li>
<li><a class="reference external" href="https://github.com/nnzhan/Graph-WaveNet">A PyTorch implementation of the GraphWaveNet model  (nnzhan)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> (<em>torch.device</em>) – Which device use to train.</li>
<li><strong>num_node</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of blocks.</li>
<li><strong>drop_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of input channels.</li>
<li><strong>supports</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Order of chebyshev polynomial.</li>
<li><strong>gcn_bool</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of chebyshev filter.</li>
<li><strong>addaptadj</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether to add adaptive adjacent matrix.</li>
<li><strong>aptinit</strong> (<em>torch.tensor</em>) – Initialization of adjacent matrix.</li>
<li><strong>in_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of input’s dimension.</li>
<li><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of output’s dimension.</li>
<li><strong>residual_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of channels after residual module.</li>
<li><strong>dilation_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of channels after dilation module.</li>
<li><strong>skip_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of skip channels.</li>
<li><strong>end_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of end channels.</li>
<li><strong>kernel_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Kernel Size for dilation convolution.</li>
<li><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of block.</li>
<li><strong>layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of layer.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-UCTB.model.STGCN">
<span id="uctb-model-stgcn-module"></span><h2>6.4.14. UCTB.model.STGCN module<a class="headerlink" href="#module-UCTB.model.STGCN" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="UCTB.model.STGCN.build_model">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">build_model</code><span class="sig-paren">(</span><em>inputs</em>, <em>n_his</em>, <em>Ks</em>, <em>Kt</em>, <em>blocks</em>, <em>keep_prob</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://www.ijcai.org/proceedings/2018/0505.pdf">Spatio-temporal graph convolutional networks: A deep learning framework for traffic forecasting.</a>.</li>
<li><a class="reference external" href="https://github.com/VeritasYin/STGCN_IJCAI-18">A Tensorflow implementation of the STGCN model  (VeritasYin)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>inputs</strong> – Placeholder.</li>
<li><strong>n_his</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Size of historical records for training.</li>
<li><strong>Ks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Kernel size of spatial convolution.</li>
<li><strong>Kt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Kernel size of temporal convolution.</li>
<li><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – Channel configs of st_conv blocks.</li>
<li><strong>keep_prob</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Placeholder.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.cheb_poly_approx">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">cheb_poly_approx</code><span class="sig-paren">(</span><em>L</em>, <em>Ks</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.cheb_poly_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>Chebyshev polynomials approximation function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>L</strong> – np.matrix, [n_route, n_route], graph Laplacian.</li>
<li><strong>Ks</strong> – int, kernel size of spatial convolution.</li>
<li><strong>n</strong> – int, number of routes / size of graph.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">np.ndarray, [n_route, Ks*n_route].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.fully_con_layer">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">fully_con_layer</code><span class="sig-paren">(</span><em>x</em>, <em>n</em>, <em>channel</em>, <em>scope</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.fully_con_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully connected layer: maps multi-channels to one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, [batch_size, 1, n_route, channel].</li>
<li><strong>n</strong> – int, number of route / size of graph.</li>
<li><strong>channel</strong> – channel size of input x.</li>
<li><strong>scope</strong> – str, variable scope.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, 1, n_route, 1].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.gconv">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">gconv</code><span class="sig-paren">(</span><em>x</em>, <em>theta</em>, <em>Ks</em>, <em>c_in</em>, <em>c_out</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.gconv" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Spectral-based graph convolution function.</dt>
<dd>x: tensor, [batch_size, n_route, c_in].
theta: tensor, [Ks*c_in, c_out], trainable kernel parameters.
Ks: int, kernel size of graph convolution.
c_in: int, size of input channel.
c_out: int, size of output channel.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tensor, [batch_size, n_route, c_out].</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.gen_batch">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">gen_batch</code><span class="sig-paren">(</span><em>inputs</em>, <em>batch_size</em>, <em>dynamic_batch=False</em>, <em>shuffle=False</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.gen_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Data iterator in batch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>inputs</strong> – np.ndarray, [len_seq, n_frame, n_route, C_0], standard sequence units.</li>
<li><strong>batch_size</strong> – int, the size of batch.</li>
<li><strong>dynamic_batch</strong> – bool, whether changes the batch size in the last batch if its length is less than the default.</li>
<li><strong>shuffle</strong> – bool, whether shuffle the batches.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.layer_norm">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">layer_norm</code><span class="sig-paren">(</span><em>x</em>, <em>scope</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.layer_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer normalization function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, [batch_size, time_step, n_route, channel].</li>
<li><strong>scope</strong> – str, variable scope.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, time_step, n_route, channel].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.output_layer">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">output_layer</code><span class="sig-paren">(</span><em>x</em>, <em>T</em>, <em>scope</em>, <em>act_func='GLU'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.output_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Output layer: temporal convolution layers attach with one fully connected layer,
which map outputs of the last st_conv block to a single-step prediction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, [batch_size, time_step, n_route, channel].</li>
<li><strong>T</strong> – int, kernel size of temporal convolution.</li>
<li><strong>scope</strong> – str, variable scope.</li>
<li><strong>act_func</strong> – str, activation function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, 1, n_route, 1].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.spatio_conv_layer">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">spatio_conv_layer</code><span class="sig-paren">(</span><em>x</em>, <em>Ks</em>, <em>c_in</em>, <em>c_out</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.spatio_conv_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial graph convolution layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, [batch_size, time_step, n_route, c_in].</li>
<li><strong>Ks</strong> – int, kernel size of spatial convolution.</li>
<li><strong>c_in</strong> – int, size of input channel.</li>
<li><strong>c_out</strong> – int, size of output channel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, time_step, n_route, c_out].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.st_conv_block">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">st_conv_block</code><span class="sig-paren">(</span><em>x</em>, <em>Ks</em>, <em>Kt</em>, <em>channels</em>, <em>scope</em>, <em>keep_prob</em>, <em>act_func='GLU'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.st_conv_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatio-temporal convolutional block, which contains two temporal gated convolution layers
and one spatial graph convolution layer in the middle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, batch_size, time_step, n_route, c_in].</li>
<li><strong>Ks</strong> – int, kernel size of spatial convolution.</li>
<li><strong>Kt</strong> – int, kernel size of temporal convolution.</li>
<li><strong>channels</strong> – list, channel configs of a single st_conv block.</li>
<li><strong>scope</strong> – str, variable scope.</li>
<li><strong>keep_prob</strong> – placeholder, prob of dropout.</li>
<li><strong>act_func</strong> – str, activation function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, time_step, n_route, c_out].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.temporal_conv_layer">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">temporal_conv_layer</code><span class="sig-paren">(</span><em>x</em>, <em>Kt</em>, <em>c_in</em>, <em>c_out</em>, <em>act_func='relu'</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.temporal_conv_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporal convolution layer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> – tensor, [batch_size, time_step, n_route, c_in].</li>
<li><strong>Kt</strong> – int, kernel size of temporal convolution.</li>
<li><strong>c_in</strong> – int, size of input channel.</li>
<li><strong>c_out</strong> – int, size of output channel.</li>
<li><strong>act_func</strong> – str, activation function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tensor, [batch_size, time_step-Kt+1, n_route, c_out].</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STGCN.variable_summaries">
<code class="descclassname">UCTB.model.STGCN.</code><code class="descname">variable_summaries</code><span class="sig-paren">(</span><em>var</em>, <em>v_name</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STGCN.variable_summaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach summaries to a Tensor (for TensorBoard visualization).
Ref: <a class="reference external" href="https://zhuanlan.zhihu.com/p/33178205">https://zhuanlan.zhihu.com/p/33178205</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>var</strong> – tf.Variable().</li>
<li><strong>v_name</strong> – str, name of the variable.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-UCTB.model.STSGCN">
<span id="uctb-model-stsgcn-module"></span><h2>6.4.15. UCTB.model.STSGCN module<a class="headerlink" href="#module-UCTB.model.STSGCN" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="UCTB.model.STSGCN.construct_adj">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">construct_adj</code><span class="sig-paren">(</span><em>A</em>, <em>steps</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.construct_adj" title="Permalink to this definition">¶</a></dt>
<dd><p>construct a bigger adjacency matrix using the given matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>np.ndarray</em><em>, </em><em>adjacency matrix</em><em>, </em><em>shape is</em><em> (</em><em>N</em><em>, </em><em>N</em><em>)</em>) – </li>
<li><strong>steps</strong> (<em>how many times of the does the new adj mx bigger than A</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>new adjacency matrix</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">csr_matrix, shape is (N * steps, N * steps)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.gcn_operation">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">gcn_operation</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>num_of_filter</em>, <em>num_of_features</em>, <em>num_of_vertices</em>, <em>activation</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.gcn_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>graph convolutional operation, a simple GCN we defined in paper</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>B</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>adj</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>3N</em><em>)</em>) – </li>
<li><strong>num_of_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C'</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'GLU'</em><em>, </em><em>'relu'}</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (3N, B, C’)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.get_adjacency_matrix">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">get_adjacency_matrix</code><span class="sig-paren">(</span><em>distance_df_filename</em>, <em>num_of_vertices</em>, <em>type_='connectivity'</em>, <em>id_filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.get_adjacency_matrix" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>distance_df_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>path of the csv file contains edges information</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>the number of vertices</em>) – </li>
<li><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{connectivity</em><em>, </em><em>distance}</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>A</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.ndarray, adjacency matrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.output_layer">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">output_layer</code><span class="sig-paren">(</span><em>data</em>, <em>num_of_vertices</em>, <em>input_length</em>, <em>num_of_features</em>, <em>num_of_filters=128</em>, <em>predict_length=12</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.output_layer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>B</em><em>, </em><em>T</em><em>, </em><em>N</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>input_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of time series</em><em>, </em><em>T</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>num_of_filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C'</em>) – </li>
<li><strong>predict_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of predicted time series</em><em>, </em><em>T'</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (B, T’, N)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.position_embedding">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">position_embedding</code><span class="sig-paren">(</span><em>data</em>, <em>input_length</em>, <em>num_of_vertices</em>, <em>embedding_size</em>, <em>temporal=True</em>, <em>spatial=True</em>, <em>init=&lt;mxnet.initializer.Xavier object&gt;</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.position_embedding" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>B</em><em>, </em><em>T</em><em>, </em><em>N</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>input_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of time series</em><em>, </em><em>T</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>embedding_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>spatial</strong> (<em>temporal</em><em>,</em>) – </li>
<li><strong>init</strong> (<em>mx.initializer.Initializer</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (B, T, N, C)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.sthgcn_layer_individual">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">sthgcn_layer_individual</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>T</em>, <em>num_of_vertices</em>, <em>num_of_features</em>, <em>filters</em>, <em>activation</em>, <em>temporal_emb=True</em>, <em>spatial_emb=True</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.sthgcn_layer_individual" title="Permalink to this definition">¶</a></dt>
<dd><p>STSGCL, multiple individual STSGCMs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>B</em><em>, </em><em>T</em><em>, </em><em>N</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>adj</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>3N</em><em>)</em>) – </li>
<li><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of time series</em><em>, </em><em>T</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>list of C'</em>) – </li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'GLU'</em><em>, </em><em>'relu'}</em>) – </li>
<li><strong>spatial_emb</strong> (<em>temporal_emb</em><em>,</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (B, T-2, N, C’)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.sthgcn_layer_sharing">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">sthgcn_layer_sharing</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>T</em>, <em>num_of_vertices</em>, <em>num_of_features</em>, <em>filters</em>, <em>activation</em>, <em>temporal_emb=True</em>, <em>spatial_emb=True</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.sthgcn_layer_sharing" title="Permalink to this definition">¶</a></dt>
<dd><p>STSGCL, multiple a sharing STSGCM</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>B</em><em>, </em><em>T</em><em>, </em><em>N</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>adj</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>3N</em><em>)</em>) – </li>
<li><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of time series</em><em>, </em><em>T</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>list of C'</em>) – </li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'GLU'</em><em>, </em><em>'relu'}</em>) – </li>
<li><strong>spatial_emb</strong> (<em>temporal_emb</em><em>,</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (B, T-2, N, C’)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.stsgcl">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">stsgcl</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>T</em>, <em>num_of_vertices</em>, <em>num_of_features</em>, <em>filters</em>, <em>module_type</em>, <em>activation</em>, <em>temporal_emb=True</em>, <em>spatial_emb=True</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.stsgcl" title="Permalink to this definition">¶</a></dt>
<dd><p>STSGCL</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>B</em><em>, </em><em>T</em><em>, </em><em>N</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>adj</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>3N</em><em>)</em>) – </li>
<li><strong>T</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>length of time series</em><em>, </em><em>T</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>list of C'</em>) – </li>
<li><strong>module_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'sharing'</em><em>, </em><em>'individual'}</em>) – </li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'GLU'</em><em>, </em><em>'relu'}</em>) – </li>
<li><strong>spatial_emb</strong> (<em>temporal_emb</em><em>,</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (B, T-2, N, C’)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.stsgcm">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">stsgcm</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>filters</em>, <em>num_of_features</em>, <em>num_of_vertices</em>, <em>activation</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.stsgcm" title="Permalink to this definition">¶</a></dt>
<dd><p>STSGCM, multiple stacked gcn layers with cropping and max operation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>B</em><em>, </em><em>C</em><em>)</em>) – </li>
<li><strong>adj</strong> (<em>mx.sym.var</em><em>, </em><em>shape is</em><em> (</em><em>3N</em><em>, </em><em>3N</em><em>)</em>) – </li>
<li><strong>filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em><em>, </em><em>list of C'</em>) – </li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>C</em>) – </li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>N</em>) – </li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>{'GLU'</em><em>, </em><em>'relu'}</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">output shape is (N, B, C’)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="UCTB.model.STSGCN.stsgcn">
<code class="descclassname">UCTB.model.STSGCN.</code><code class="descname">stsgcn</code><span class="sig-paren">(</span><em>data</em>, <em>adj</em>, <em>label</em>, <em>input_length</em>, <em>num_of_vertices</em>, <em>num_of_features</em>, <em>filter_list</em>, <em>module_type</em>, <em>activation</em>, <em>use_mask=True</em>, <em>mask_init_value=None</em>, <em>temporal_emb=True</em>, <em>spatial_emb=True</em>, <em>prefix=''</em>, <em>rho=1</em>, <em>predict_length=12</em><span class="sig-paren">)</span><a class="headerlink" href="#UCTB.model.STSGCN.stsgcn" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://ojs.aaai.org/index.php/AAAI/article/view/5438">Spatial-temporal synchronous graph convolutional networks: A new framework for spatial-temporal network data forecasting.</a>.</li>
<li><a class="reference external" href="https://github.com/Davidham3/STSGCN">A Mxnet implementation of the stsgcn model  (Davidham3)</a>.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>mxnet.sym</em>) – Input data.</li>
<li><strong>adj</strong> (<em>mxnet.sym</em>) – Adjacent matrix.</li>
<li><strong>label</strong> (<em>mxnet.sym</em>) – Prediction label.</li>
<li><strong>input_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Length of input data.</li>
<li><strong>num_of_vertices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of vertices in the graph.</li>
<li><strong>num_of_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Number of features of each vertice.</li>
<li><strong>filter_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a>) – Filters.</li>
<li><strong>module_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Whether sharing weights.</li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Choose which activate function.</li>
<li><strong>use_mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether we use mask.</li>
<li><strong>mask_init_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Initial value of mask.</li>
<li><strong>temporal_emb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether to use temporal embedding.</li>
<li><strong>spatial_emb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Whether to use spatial embedding.</li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – String prefix of mask.</li>
<li><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Hyperparameters used to calculate huber loss.</li>
<li><strong>predict_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Length of prediction.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="UCTB.evaluation.html" class="btn btn-neutral float-right" title="6.5. UCTB.evaluation package" accesskey="n">Next →</a>
      
      
        <a href="UCTB.model_unit.html" class="btn btn-neutral" title="6.3. UCTB.model_unit package" accesskey="p">← Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, UCTB group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE: 'true'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>